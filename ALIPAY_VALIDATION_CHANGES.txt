=== ALIPAY PAYMENT FORM - PERSONAL ACCOUNT VALIDATION ===

CHANGES NEEDED IN: frontend/src/pages/Quicklinks/AlipayPayment.jsx

═══════════════════════════════════════════════════════════════

CHANGE 1: Add FaEnvelope to imports (Line ~3-13)
─────────────────────────────────────────────────────────────
FIND:
import {
  FaExchangeAlt,
  FaUser,
  FaMoneyBillWave,
  FaAlipay,
  FaShieldAlt,
  FaCheckCircle,
  FaInfoCircle,
  FaLock,
  FaQrcode,
  FaUpload,
} from "react-icons/fa";

REPLACE WITH:
import {
  FaExchangeAlt,
  FaUser,
  FaMoneyBillWave,
  FaAlipay,
  FaShieldAlt,
  FaCheckCircle,
  FaInfoCircle,
  FaLock,
  FaQrcode,
  FaUpload,
  FaEnvelope,
} from "react-icons/fa";

═══════════════════════════════════════════════════════════════

CHANGE 2: Add email state (Line ~79)
─────────────────────────────────────────────────────────────
FIND:
  const [alipayAccount, setAlipayAccount] = useState("");
  const [realName, setRealName] = useState("");
  const [qrCode, setQrCode] = useState(null);

REPLACE WITH:
  const [alipayAccount, setAlipayAccount] = useState("");
  const [realName, setRealName] = useState("");
  const [email, setEmail] = useState("");
  const [qrCode, setQrCode] = useState(null);

═══════════════════════════════════════════════════════════════

CHANGE 3: Add phone validation function (Line ~149, after handlePlatformChange)
─────────────────────────────────────────────────────────────
ADD AFTER:
  const handlePlatformChange = (platform) => {
    setPlatformSource(platform);
  };

NEW CODE TO ADD:
  const validatePhoneFormat = (phone) => {
    // Format: 233-000000000 (9 digits) or 233-0000000000 (10 digits)
    const phoneRegex = /^233-\d{9,10}$/;
    return phoneRegex.test(phone);
  };

═══════════════════════════════════════════════════════════════

CHANGE 4: Add validation in proceedToPaymentInstructions (Line ~187)
─────────────────────────────────────────────────────────────
FIND:
    if (!alipayAccount.trim()) {
      toast.error("Please enter your Alipay account");
      return;
    }

    if (!realName.trim()) {

ADD AFTER THE alipayAccount CHECK:
    if (!alipayAccount.trim()) {
      toast.error("Please enter your Alipay account");
      return;
    }

    // Validate personal account format
    if (accountType === "personal") {
      if (!validatePhoneFormat(alipayAccount)) {
        toast.error("Personal account must be in format: 233-000000000 or 233-0000000000");
        return;
      }
      if (!email.trim()) {
        toast.error("Email is required for personal accounts");
        return;
      }
      // Basic email validation
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        toast.error("Please enter a valid email address");
        return;
      }
    }

    if (!realName.trim()) {

═══════════════════════════════════════════════════════════════

CHANGE 5: Add email field in form (Line ~665, after Real Name input)
─────────────────────────────────────────────────────────────
FIND:
                      {/* Real Name Input */}
                      <div className="space-y-2">
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                          Real Name on Account{" "}
                          <span className="text-red-500">*</span>
                        </label>
                        <div className="relative">
                          <div className="absolute left-4 top-1/2 -translate-y-1/2">
                            <FaUser className="w-5 h-5 text-blue-500" />
                          </div>
                          <input
                            type="text"
                            value={realName}
                            onChange={(e) => setRealName(e.target.value)}
                            className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                            placeholder="Enter real name"
                          />
                        </div>
                      </div>
                    </div>

ADD AFTER THE CLOSING </div> OF THE GRID:
                    {/* Email Input - Only for Personal Accounts */}
                    {accountType === "personal" && (
                      <div className="space-y-2">
                        <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                          Email Address <span className="text-red-500">*</span>
                        </label>
                        <div className="relative">
                          <div className="absolute left-4 top-1/2 -translate-y-1/2">
                            <FaEnvelope className="w-5 h-5 text-blue-500" />
                          </div>
                          <input
                            type="email"
                            value={email}
                            onChange={(e) => setEmail(e.target.value)}
                            className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                            placeholder="Enter email address"
                          />
                        </div>
                        <p className="text-xs text-gray-500 dark:text-gray-400">
                          Required for personal accounts
                        </p>
                      </div>
                    )}

═══════════════════════════════════════════════════════════════

CHANGE 6: Update Alipay Account placeholder for personal (Line ~640)
─────────────────────────────────────────────────────────────
FIND:
                          <input
                            type="text"
                            value={alipayAccount}
                            onChange={(e) => setAlipayAccount(e.target.value)}
                            className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                            placeholder="Enter Alipay account"
                          />

REPLACE WITH:
                          <input
                            type="text"
                            value={alipayAccount}
                            onChange={(e) => setAlipayAccount(e.target.value)}
                            className="w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                            placeholder={accountType === "personal" ? "233-0000000000" : "Enter Alipay account"}
                          />
                        </div>
                        {accountType === "personal" && (
                          <p className="text-xs text-gray-500 dark:text-gray-400">
                            Format: 233-000000000 or 233-0000000000
                          </p>
                        )}
                      </div>

═══════════════════════════════════════════════════════════════

CHANGE 7: Add email to paymentData (Line ~220)
─────────────────────────────────────────────────────────────
FIND:
      const paymentData = {
        accountType,
        alipayAccount,
        realName,
        qrCodeImage: qrCodeData,
        proofOfPayment: proofOfPaymentPreview,
        originalCurrency: currency,

REPLACE WITH:
      const paymentData = {
        accountType,
        alipayAccount,
        realName,
        email: accountType === "personal" ? email : "",
        qrCodeImage: qrCodeData,
        proofOfPayment: proofOfPaymentPreview,
        originalCurrency: currency,

═══════════════════════════════════════════════════════════════

SUMMARY:
- Personal accounts now require phone format: 233-000000000 or 233-0000000000
- Personal accounts now require email address
- Email field only shows when personal account type is selected
- Validation happens before proceeding to payment instructions
- Email is included in the payment data submission

═══════════════════════════════════════════════════════════════
